###---------------------------------------------------------------
#   Model: emucharts_MedtronicMinimed530G_MisraC
#   Author: <author name>
#           <affiliation>
#           <contact>
#  ---------------------------------------------------------------##

NAME = main
CC = gcc
CFLAGS = -Wall -O2 -Werror -Wmissing-noreturn -Wpacked -Wunreachable-code
LDFLAGS= -lm
DEBUG = -Wall -O2 -Werror -Wmissing-noreturn -Wpacked -Wunreachable-code -D DEBUG
HEAD = emucharts_MedtronicMinimed530G_MisraC.h
SOURCES = emucharts_MedtronicMinimed530G_MisraC.c main.c
OBJ = $(SOURCES:.c=.o)
DEBUGFILES = main.dSYM

.PHONY : clean help install uninstall

%.o: %.c $(HEAD)
	@$(CC) $(CFLAGS) -c $< -o $@ 

build: $(NAME)

debug:$(OBJ)
	@$(CC) $(DEBUG) -g $(SOURCES) -o $(NAME) $(LDFLAGS)
	-@rm -r main.o
	@echo " "
	@echo "\033[1m$(OBJ)\033[0m compiled successfully in debug mode"
	@echo "executable file (main) was generated for illustrative purposes"
	
$(NAME): $(OBJ)
	@$(CC) $(CFLAGS) -o $@ $^ $(LDFLAGS)
	-@rm -r main.o
	@echo " "
	@echo "\033[1m$(OBJ)\033[0m compiled successfully!"
	@echo "executable file (main) was generated for illustrative purposes"
	@echo " "
	@echo "Edit 'main.c' file and compile again if you want to try to interact with the generated functions."

install:
	-@cp ./$(OBJ) /usr/bin
	@echo $(OBJ) "installed in /usr/bin"

uninstall:
	-@rm /usr/bin/$(OBJ)
	@echo $(OBJ) "uninstalled from /usr/bin"

clean:
	-@rm -f -r ./*.o $(NAME) $(DEBUGFILES)
	@echo $(OBJ) "removed successfully!"

android:
	@sed -i-e 's/st->//' Android_emucharts_MedtronicMinimed530G_MisraC.c
	@sed -i-e 's/st->//' Android_emucharts_MedtronicMinimed530G_MisraC.h
	@sed -i-e 's/JNICALL /JNICALL $(PROJECT)/' Android_emucharts_MedtronicMinimed530G_MisraC.c
	@sed -i-e 's/JNICALL /JNICALL $(PROJECT)/' Android_emucharts_MedtronicMinimed530G_MisraC.h
	@sed rm Android_emucharts_MedtronicMinimed530G_MisraC.c-e
	@sed rm Android_emucharts_MedtronicMinimed530G_MisraC.h-e
	@echo "Edited 'Android_emucharts_MedtronicMinimed530G_MisraC.c' and 'Android_emucharts_MedtronicMinimed530G_MisraC.h' in order to use them with NDK."

help:
	@echo
	@echo "Makefile"
	@echo
	@echo "make/make build  : build all"
	@echo "debug 			: enable and compile in debug mode"
	@echo "install          : install tool in the system. Root permission required"
	@echo "uninstall        : remove tool from system. Root permission required"
	@echo "clean            : remove all .o files and executable file"
	@echo "NAME=yourname    : change program name, default is: 'main' "
	@echo "android		    : edit Android files for an utilization with NDK"
	@echo "PROJECT=your_android_project_path_and_activity"
	@echo
	@echo  "-------------------------------------------------------------"
	@echo  "  Makefile generated using PVSio-web MisraCPrinter ver 0.1"
	@echo  "  Tool freely available at http:##www.pvsioweb.org"
	@echo  "-------------------------------------------------------------" 
	@echo


### ---------------------------------------------------------------
#   Makefile generated using PVSio-web MisraCPrinter ver 1.0
#   Tool freely available at http:##www.pvsioweb.org
#  --------------------------------------------------------------##

